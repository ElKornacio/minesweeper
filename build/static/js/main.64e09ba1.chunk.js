(this.webpackJsonpminesweeper=this.webpackJsonpminesweeper||[]).push([[0],{15:function(e,t,n){},17:function(e,t,n){},18:function(e,t,n){},19:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(10),c=n.n(i),o=n(2),s=n(4),l=n(6),u=n(5),f=n.n(u),d=(n(15),n(0));function h(e){var t=e.value,n=(e.className,Object(l.a)(e,["value","className"]));if(t<0)return null;var a=t.toString().padStart(3,"0").split("");return Object(d.jsx)("div",Object(s.a)(Object(s.a)({className:"digits-counter"},n),{},{children:a.map((function(e,t){return Object(d.jsx)("div",{className:f()("digit","d"+e)},t)}))}))}n(17);function m(e){var t=e.state,n=Object(l.a)(e,["state"]);return Object(d.jsx)("div",Object(s.a)({className:f()("face-button","state-"+t)},n))}function j(e){return{width:e.clientWidth,height:e.clientHeight}}var b,v=n(3),O=30,w=(b={0:"closed",1:"closed",2:"closed",3:"closed",4:"closed",5:"closed",6:"closed",7:"closed",8:"closed",9:"closed",10:"empty",11:"m1",12:"m2",13:"m3",14:"m4",15:"m5",16:"m6",17:"m7",18:"m8",19:"mine",20:"flag",21:"flag",22:"flag",23:"flag",24:"flag",25:"flag",26:"flag",27:"flag",28:"flag",29:"flag"},Object(v.a)(b,255,"empty"),Object(v.a)(b,254,"closed"),Object(v.a)(b,253,"mine"),Object(v.a)(b,252,"exploded"),Object(v.a)(b,251,"flag"),Object(v.a)(b,250,"flag-wrong"),b),g=function(e){return e.preventDefault()};function p(e){var t=e.state,n=e.className,a=e.x,r=e.y,i=e.onCellClick,c=Object(l.a)(e,["state","className","x","y","onCellClick"]),o=w[t];return Object(d.jsx)("div",Object(s.a)({className:f()("cell","cell-".concat(o),n),onContextMenu:g,onMouseUp:function(e){e.preventDefault(),e.stopPropagation(),i(0===e.button,a,r)}},c))}function x(e){for(var t=e.params,n=e.field,a=e.smallSlice,r=e.onCellClick,i=[],c=a.xStart;c<a.xEnd;c++)for(var o=a.yStart;o<a.yEnd;o++)i.push(Object(d.jsx)(p,{style:{transform:"translate(".concat((c-a.xStart)*O,"px, ").concat((o-a.yStart)*O,"px)")},x:c,y:o,state:n[c*t.columns+o],onCellClick:r},"".concat(c-a.xStart,":").concat(o-a.yStart)));return Object(d.jsx)(d.Fragment,{children:i})}function S(e){var t=e.params,n=e.field,a=e.slice,r=e.onCellClick;return Object(d.jsx)("div",{className:"field",style:{width:(a.xEnd-a.xStart)*O+2,height:(a.yEnd-a.yStart)*O+2,transform:"translate(".concat(a.tX,"px, ").concat(a.tY,"px)")},children:Object(d.jsx)(x,{params:t,field:n,smallSlice:a,onCellClick:r})})}var y=n(9);function N(e,t){if(t>e)throw new Error("Cant generate more unique indexes than array length");for(var n=[],a=0;a<t;a++){for(var r=void 0;n.includes(r=Math.floor(Math.random()*e)););n.push(r)}return n}function C(e){for(var t=e.columns*e.rows,n=e.mines,a=new Uint8Array(t),r=n/t,i=new Uint32Array(Math.min(t,5*n)),c=new Uint32Array(Math.min(t,5*(t-n))),o=0,s=0,l=0,u=0;u<a.length;u++)Math.random()<r?(a[u]=9,i[o++]=u,l++):(a[u]=0,c[s++]=u);if(l>n){var f,d=N(o,l-n),h=Object(y.a)(d);try{for(h.s();!(f=h.n()).done;){a[i[f.value]]=0,l--}}catch(x){h.e(x)}finally{h.f()}}else if(l<n){var m,j=N(s,n-l),b=Object(y.a)(j);try{for(b.s();!(m=b.n()).done;){a[c[m.value]]=9,l++}}catch(x){b.e(x)}finally{b.f()}}for(var v=function(t,n){return t*e.columns+n},O=0;O<e.columns;O++)for(var w=0;w<e.rows;w++){var g=v(O,w);if(0===a[g]){var p=0;w-1>=0&&(p+=O-1>=0&&9===a[v(O-1,w-1)]?1:0,p+=9===a[v(O,w-1)]?1:0,p+=O+1<e.columns&&9===a[v(O+1,w-1)]?1:0),w+1<e.rows&&(p+=O-1>=0&&9===a[v(O-1,w+1)]?1:0,p+=9===a[v(O,w+1)]?1:0,p+=O+1<e.columns&&9===a[v(O+1,w+1)]?1:0),p+=O-1>=0&&9===a[v(O-1,w)]?1:0,p+=O+1<e.columns&&9===a[v(O+1,w)]?1:0,a[g]=p}}return a}n(18);function M(e){var t=e.params,n=e.onGameStateUpdate,r=e.field,i=e.onFieldUpdate,c=e.onAddFlag,s=e.onRemoveFlag,l=Object(a.useRef)(null),u=function(e){var t=Object(a.useState)({width:800,height:600}),n=Object(o.a)(t,2),r=n[0],i=n[1];return Object(a.useEffect)((function(){var t=j(e.current);i(t);var n=function(){var t=j(e.current);i(t)};return window.addEventListener("resize",n),function(){return window.removeEventListener("resize",n)}}),[]),r}(l),f=function(e,n){return e*t.columns+n},h={width:O*t.columns,height:O*t.rows},m=function(e,t){var n=0,a=0;return e.width<t.width&&(n=(t.width-e.width)/2),e.height<t.height&&(a=(t.height-e.height)/2),{initialX:n,initialY:a}}(h,u),b=m.initialX,v=m.initialY,w=Object(a.useState)(b),g=Object(o.a)(w,2),p=g[0],x=g[1],y=Object(a.useState)(v),N=Object(o.a)(y,2),C=N[0],M=N[1];Object(a.useEffect)((function(){x(b),M(v)}),[t]);var E,k,U,A,F=Math.floor(u.width/O)+6,X=Math.floor(u.height/O)+6;if(h.width>u.width){var Y=Math.floor(-p/O);E=Y<3?0:Y-3,k=Y<3?p:p+E*O}else E=0,k=p;if(h.width>u.width){var G=Math.floor(-C/O);U=G<3?0:G-3,A=G<3?C:C+U*O}else U=0,A=C;var L={tX:k,tY:A,xStart:E,xEnd:Math.min(t.columns,E+F),yStart:U,yEnd:Math.min(t.rows,U+X)},R=function(e,n,a){return e<0||n<0||e>=t.columns||n>=t.rows?-1:a[f(e,n)]},I=function(e,n,a){var r=3e8,i=new Uint32Array(r),c=new Uint32Array(r);i[0]=f(e,n);for(var o=1,s=function(e,t){R(e,t,a);o>=r?c[o++-r]=f(e,t):i[o++]=f(e,t)};o;){var l=void 0;l=o>=r?c[--o-r]:i[--o];var u=Math.floor(l/t.columns),d=l%t.columns,h=R(u,d,a);-1!==h&&h<10&&9!==h&&(a[f(u,d)]+=10),0===h&&(s(u-1,d-1),s(u,d-1),s(u+1,d-1),s(u-1,d),s(u+1,d),s(u-1,d+1),s(u,d+1),s(u+1,d+1))}},z=Object(a.useCallback)((function(e,t,a){if(r){var o=new Uint8Array(r),l=o[f(t,a)];if(e){if(l>=10)return;if(0===l)I(t,a,o);else{if(9===l)return function(e,t){if(r){var a=new Uint8Array(r);a[f(e,t)]=252;for(var c=0;c<a.length;c++){var o=a[c];o<10?o+=10:o<30&&o>=20&&29!==o&&(o=250),a[c]=o}i(a),n("lose")}}(t,a);o[f(t,a)]+=10}}else l<10?(o[f(t,a)]+=20,c()):l>=20&&l<30&&(o[f(t,a)]-=20,s());i(o)}}),[r,t]);return Object(a.useEffect)((function(){h.width<u.width&&x((u.width-h.width)/2),h.height<u.height&&M((u.height-h.height)/2)}),[u]),Object(d.jsx)("div",{ref:l,className:"field-wrapper",onWheel:function(e){var t=p-e.deltaX,n=C-e.deltaY;h.width<u.width?t=(u.width-h.width)/2:h.width>u.width&&t<-1*(h.width-u.width)?t=-1*(h.width-u.width):t>0&&(t=0),h.height<u.height?n=(u.height-h.height)/2:h.height>u.height&&n<-1*(h.height-u.height)?n=-1*(h.height-u.height):n>0&&(n=0),x(t),M(n)},children:r?Object(d.jsx)(S,{onCellClick:z,slice:L,field:r,params:t}):null})}window.generateField=function(e,t,n){return C({columns:e,rows:t,mines:n})};n(19);var E=C({columns:20,rows:20,mines:70});function k(e){var t=e.params,n=e.gameId,r=e.gameState,i=e.onNewGame,c=e.minesLeft,s=Object(a.useState)(0),l=Object(o.a)(s,2),u=l[0],f=l[1];return Object(a.useEffect)((function(){var e=null;return"none"===r&&(e=setTimeout((function(){return f(u+1)}),1e3)),function(){return e?clearTimeout(e):void 0}}),[u,r]),Object(a.useEffect)((function(){"none"===r&&f(0)}),[n,r]),Object(d.jsxs)("div",{className:"header",children:[Object(d.jsx)("div",{className:"time",children:Object(d.jsx)(h,{value:u})}),Object(d.jsx)("div",{className:"restart",children:Object(d.jsx)(m,{state:"none"===r?"unpressed":"lose"===r?"lose":"win",onClick:function(){var e=prompt("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0447\u0435\u0440\u0435\u0437 \u0437\u0430\u043f\u044f\u0442\u0443\u044e: Columns,Rows,Mines","".concat(t.columns,",").concat(t.rows,",").concat(t.mines)).split(","),n=Object(o.a)(e,3),a=n[0],r=n[1],c=n[2];i(Number(a),Number(r),Number(c))}})}),Object(d.jsx)("div",{className:"mines-left",children:Object(d.jsx)(h,{value:c})})]})}var U=function(){var e=Object(a.useState)("1"),t=Object(o.a)(e,2),n=t[0],r=(t[1],Object(a.useState)(0)),i=Object(o.a)(r,2),c=i[0],s=i[1],l=Object(a.useState)("none"),u=Object(o.a)(l,2),f=u[0],h=u[1],m=Object(a.useState)(E),j=Object(o.a)(m,2),b=j[0],v=j[1],O=Object(a.useState)("20"),w=Object(o.a)(O,2),g=w[0],p=w[1],x=Object(a.useState)("20"),S=Object(o.a)(x,2),y=S[0],N=S[1],U=Object(a.useState)("70"),A=Object(o.a)(U,2),F=A[0],X=A[1],Y=Object(a.useCallback)((function(e,t,n){p(String(e)),N(String(t)),X(String(n)),v(C({columns:e,rows:t,mines:n})),h("none")}),[]);return Object(d.jsxs)("div",{className:"app",onClick:console.log,children:[Object(d.jsx)(k,{params:{columns:Number(g),rows:Number(y),mines:Number(F)},gameId:n,gameState:f,onNewGame:Y,minesLeft:Number(F)-c}),Object(d.jsx)(M,{params:{columns:Number(g),rows:Number(y),mines:Number(F)},onGameStateUpdate:h,onAddFlag:function(){s(c+1)},onRemoveFlag:function(){s(c-1)},field:b,onFieldUpdate:v})]})};c.a.render(Object(d.jsx)(r.a.StrictMode,{children:Object(d.jsx)(U,{})}),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.64e09ba1.chunk.js.map